#!/usr/bin/env bash

MAIN_FILESYSTEMS="audiobooks books comics documentaries documents exercise learning movies music photos stand-up television"
RECURISVE_FILESYSTEMS="appdata database"
SYNC_USER=root
SYNC_HOST=backup.netbird.cloud
LOG=/var/log/syncoid.log

{
  for i in $MAIN_FILESYSTEMS; do
    echo "---------------  $(date) - syncing $i -------------"
    /usr/sbin/syncoid \
      --no-sync-snap \
      --recvoptions="o compression=lz4" \
      --create-bookmark \
      --compress none \
      --source-bwlimit 200m \
      storage/"$i" \
      $SYNC_USER@$SYNC_HOST:storage/"$i"
    echo "---------------  $(date) - done $i -------------"
  done
} >> $LOG 2>&1

{
  for i in $RECURISVE_FILESYSTEMS; do
    echo "---------------  $(date) - syncing $i -------------"
    /usr/sbin/syncoid \
      --recursive \
      --no-sync-snap \
      --skip-parent \
      --recvoptions="o compression=lz4" \
      --create-bookmark \
      --compress none \
      --source-bwlimit 200m \
      storage/"$i" \
      $SYNC_USER@$SYNC_HOST:storage/"$i"
    echo "---------------  $(date) - done $i -------------"
  done
} >> $LOG 2>&1
